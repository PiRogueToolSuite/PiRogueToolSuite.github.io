<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><link rel=preload as=font href=/fonts/vendor/jost/jost-v4-latin-regular.woff2 type=font/woff2 crossorigin><link rel=preload as=font href=/fonts/vendor/jost/jost-v4-latin-700.woff2 type=font/woff2 crossorigin><script>(()=>{var t=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches,e=localStorage.getItem("theme");t&&e===null&&(localStorage.setItem("theme","dark"),document.documentElement.setAttribute("data-dark-mode","")),t&&e==="dark"&&document.documentElement.setAttribute("data-dark-mode",""),e==="dark"&&document.documentElement.setAttribute("data-dark-mode","")})()</script><link rel=stylesheet href=/main.a6a33d0aa5f34ca000e1ac548fd41b2bf0eb9f78eb235185d2a775f2742b9458f098ff2fceb0371eeefadcc7c7c897cc822d3074a1fd31317fe65c21f4b2a310.css integrity="sha512-pqM9CqXzTKAA4axUj9QbK/Drn3jrI1GF0qd18nQrlFjwmP8vzrA3Hu763MfHyJfMgi0wdKH9MTF/5lwh9LKjEA==" crossorigin=anonymous><noscript><style>img.lazyload{display:none}</style></noscript><meta name=robots content="index, follow"><meta name=googlebot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><meta name=bingbot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><title>How to intercept and decrypt TLS traffic - PiRogue tool suite</title><meta name=description content="This recipe is dedicated to intrepid users 😎
PiRogue comes with a pirogue-intercept-* helpers to help you intercept encrypted TLS traffic from applications, even in presence of TLS certificate pinning.
These helpers are meant to:
capture the network traffic instrument a specific application or any launched application Requirements # To follow this recipe, you need:
an up-to-date PiRogue a rooted Android device Procedure # First, SSH onto your PiRogue. Attach your smartphone to the PiRogue through USB and make sure &amp;ldquo;USB debugging&amp;rdquo; is on and working."><link rel=canonical href=/docs/recipes/how-to-intercept-and-decrypt-tls-traffic/><meta property="og:locale" content="en_US"><meta property="og:type" content="article"><meta property="og:title" content="How to intercept and decrypt TLS traffic"><meta property="og:description" content="This recipe is dedicated to intrepid users 😎
PiRogue comes with a pirogue-intercept-* helpers to help you intercept encrypted TLS traffic from applications, even in presence of TLS certificate pinning.
These helpers are meant to:
capture the network traffic instrument a specific application or any launched application Requirements # To follow this recipe, you need:
an up-to-date PiRogue a rooted Android device Procedure # First, SSH onto your PiRogue. Attach your smartphone to the PiRogue through USB and make sure &ldquo;USB debugging&rdquo; is on and working."><meta property="og:url" content="/docs/recipes/how-to-intercept-and-decrypt-tls-traffic/"><meta property="og:site_name" content="PiRogue tool suite"><meta property="article:published_time" content="2022-08-19T00:00:00+00:00"><meta property="article:modified_time" content="2022-08-19T00:00:00+00:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:site content="@PiRogueTools"><meta name=twitter:creator content="@u039b"><meta name=twitter:title content="How to intercept and decrypt TLS traffic"><meta name=twitter:description content><meta name=twitter:card content="summary"><meta name=twitter:image:alt content="How to intercept and decrypt TLS traffic"><script type=application/ld+json>{"@context":"https://schema.org","@graph":[{"@type":"Organization","@id":"/#/schema/organization/1","name":"PiRogue tool suite","url":"/","sameAs":["https://twitter.com/PiRogueTools","https://github.com/PiRogueToolSuite/"],"logo":{"@type":"ImageObject","@id":"/#/schema/image/1","url":"/android-chrome-512x512.png","width":512,"height":512,"caption":"PiRogue tool suite"},"image":{"@id":"/#/schema/image/1"}},{"@type":"WebSite","@id":"/#/schema/website/1","url":"/","name":"PiRogue tool suite","description":"PiRogue tool suite (PTS) is an open-source tool suite that provides a comprehensive mobile forensic and network traffic analysis platform targeting mobile devices both Android and iOS, internet of things devices (devices that are connected to the user mobile apps), and in general any device using wi-fi to connect to the Internet.","publisher":{"@id":"/#/schema/organization/1"}},{"@type":"WebPage","@id":"/docs/recipes/how-to-intercept-and-decrypt-tls-traffic/","url":"/docs/recipes/how-to-intercept-and-decrypt-tls-traffic/","name":"How to intercept and decrypt TLS traffic","description":"","isPartOf":{"@id":"/#/schema/website/1"},"about":{"@id":"/#/schema/organization/1"},"datePublished":"2022-08-19T00:00:00CET","dateModified":"2022-08-19T00:00:00CET","breadcrumb":{"@id":"/docs/recipes/how-to-intercept-and-decrypt-tls-traffic/#/schema/breadcrumb/1"},"primaryImageOfPage":{"@id":"/docs/recipes/how-to-intercept-and-decrypt-tls-traffic/#/schema/image/2"},"inLanguage":"en-US","potentialAction":[{"@type":"ReadAction","target":["/docs/recipes/how-to-intercept-and-decrypt-tls-traffic/"]}]},{"@type":"BreadcrumbList","@id":"/docs/recipes/how-to-intercept-and-decrypt-tls-traffic/#/schema/breadcrumb/1","name":"Breadcrumbs","itemListElement":[{"@type":"ListItem","position":1,"item":{"@type":"WebPage","@id":"/","url":"/","name":"Home"}},{"@type":"ListItem","position":2,"item":{"@id":"/docsrecipeshow-to-intercept-and-decrypt-tls-traffic/"}}]},{"@context":"https://schema.org","@graph":[{"@type":"Article","@id":"/#/schema/article/1","headline":"How to intercept and decrypt TLS traffic","description":"","isPartOf":{"@id":"/docs/recipes/how-to-intercept-and-decrypt-tls-traffic/"},"mainEntityOfPage":{"@id":"/docs/recipes/how-to-intercept-and-decrypt-tls-traffic/"},"datePublished":"2022-08-19T00:00:00CET","dateModified":"2022-08-19T00:00:00CET","author":{"@id":"/#/schema/person/2"},"publisher":{"@id":"/#/schema/organization/1"},"image":{"@id":"/docs/recipes/how-to-intercept-and-decrypt-tls-traffic/#/schema/image/2"}}]},{"@context":"https://schema.org","@graph":[{"@type":"Person","@id":"/#/schema/person/2","name":"Esther Onfroy","sameAs":["https://twitter.com/u039b","https://github.com/u039b"]}]},{"@context":"https://schema.org","@graph":[{"@type":"ImageObject","@id":"/docs/recipes/how-to-intercept-and-decrypt-tls-traffic/#/schema/image/2","url":null,"contentUrl":null,"caption":"How to intercept and decrypt TLS traffic"}]}]}</script><meta name=theme-color content="#fff"><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest crossorigin=use-credentials href=/site.webmanifest></head><body class="docs single"><div class=header-bar></div><header class="navbar navbar-expand-md navbar-light doks-navbar"><nav class="container-xxl flex-wrap flex-md-nowrap" aria-label="Main navigation"><a class="navbar-brand p-0 me-auto" href=/ aria-label="PiRogue tool suite">PiRogue tool suite</a>
<button class="btn btn-menu d-block d-md-none order-5" type=button data-bs-toggle=offcanvas data-bs-target=#offcanvasDoks aria-controls=offcanvasDoks aria-label="Open main menu"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="18" x2="21" y2="18"/></svg></button><div class="offcanvas offcanvas-start border-0 py-md-1" tabindex=-1 id=offcanvasDoks data-bs-backdrop=true aria-labelledby=offcanvasDoksLabel><div class="header-bar d-md-none"></div><div class="offcanvas-header d-md-none"><h2 class="h5 offcanvas-title ps-2" id=offcanvasDoksLabel><a class=text-dark href=/>PiRogue tool suite</a></h2><button type=button class="btn-close text-reset me-2" data-bs-dismiss=offcanvas aria-label="Close main menu"></button></div><div class="offcanvas-body px-4"><h3 class="h6 text-uppercase mb-3 d-md-none">Main</h3><ul class="nav flex-column flex-md-row ms-md-n3"><li class=nav-item><a class="nav-link ps-0 py-1" href=/guides/>Guides</a></li><li class=nav-item><a class="nav-link ps-0 py-1 active" href=/docs/prologue/introduction/>Docs</a></li><li class=nav-item><a class="nav-link ps-0 py-1" href=/blog/>Blog</a></li><li class=nav-item><a class="nav-link ps-0 py-1" href=/contributors/>Contributors</a></li><li class=nav-item><a class="nav-link ps-0 py-1" href=/about/>About</a></li><li class=nav-item><a class="nav-link ps-0 py-1" href=/contact/>Contact</a></li></ul><hr class="text-black-50 my-4 d-md-none"><h3 class="h6 text-uppercase mb-3 d-md-none">Socials</h3><ul class="nav flex-column flex-md-row ms-md-auto me-md-n5 pe-md-2"><li class=nav-item><a class="nav-link ps-0 py-1" href=https://github.com/PiRogueToolSuite><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-github"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg><small class="ms-2 d-md-none">GitHub</small></a></li><li class=nav-item><a class="nav-link ps-0 py-1" href=https://twitter.com/PiRogueTools><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-twitter"><path d="M23 3a10.9 10.9.0 01-3.14 1.53 4.48 4.48.0 00-7.86 3v1A10.66 10.66.0 013 4s-4 9 5 13a11.64 11.64.0 01-7 2c9 5 20 0 20-11.5a4.5 4.5.0 00-.08-.83A7.72 7.72.0 0023 3z"/></svg><small class="ms-2 d-md-none">Twitter</small></a></li><li class=nav-item><a class="nav-link ps-0 py-1" href=https://discord.gg/qGX73GYNdp><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-message-square"><path d="M21 15a2 2 0 01-2 2H7l-4 4V5a2 2 0 012-2h14a2 2 0 012 2z"/></svg><small class="ms-2 d-md-none">Discord</small></a></li></ul></div></div><button id=mode class="btn btn-link order-md-1" type=button aria-label="Toggle user interface mode">
<span class=toggle-dark><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-moon"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg></span><span class=toggle-light><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-sun"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></span></button></nav></header><nav class="doks-subnavbar py-2 sticky-lg-top" aria-label="Secondary navigation"><div class="container-xxl d-flex align-items-md-center"><form class="doks-search position-relative flex-grow-1 me-auto"><input id=search class="form-control is-search" type=search placeholder="Search docs..." aria-label="Search docs..." autocomplete=off><div id=suggestions class="shadow bg-white rounded d-none"></div></form><button class="btn doks-sidebar-toggle d-lg-none ms-3 order-3 collapsed" type=button data-bs-toggle=collapse data-bs-target=#doks-docs-nav aria-controls=doks-docs-nav aria-expanded=false aria-label="Toggle documentation navigation"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="doks doks-expand" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Expand</title><polyline points="7 13 12 18 17 13"/><polyline points="7 6 12 11 17 6"/></svg><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="doks doks-collapse" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Collapse</title><polyline points="17 11 12 6 7 11"/><polyline points="17 18 12 13 7 18"/></svg></button></div></nav><div class=container-xxl><aside class=doks-sidebar><nav id=doks-docs-nav class="collapse d-lg-none" aria-label="Tertiary navigation"><ul class="list-unstyled collapsible-sidebar"><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-5f2cae171c6192fa410df4385f7218aa aria-expanded=false>
Prologue</button><div class=collapse id=section-5f2cae171c6192fa410df4385f7218aa><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=/docs/prologue/introduction/>Introduction</a></li><li><a class="docs-link rounded" href=/docs/prologue/quick-start/>Quick Start</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-156eb3d3f8417d06d51d14197a51282b aria-expanded=false>
The PiRogue</button><div class=collapse id=section-156eb3d3f8417d06d51d14197a51282b><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=/docs/pirogue/overview/>Overview</a></li><li><a class="docs-link rounded" href=/docs/pirogue/build-a-pirogue/>Build a PiRogue</a></li><li><a class="docs-link rounded" href=/docs/pirogue/build-a-pirogue-hat/>Build a PiRogue hat</a></li><li><a class="docs-link rounded" href=/docs/pirogue/build-a-pirogue-case/>Build a PiRogue case</a></li><li><a class="docs-link rounded" href=/docs/pirogue/configure-a-pirogue/>Configure a PiRogue</a></li><li><a class="docs-link rounded" href=/docs/pirogue/upgrade-a-pirogue/>Upgrade a PiRogue</a></li><li><a class="docs-link rounded" href=/docs/pirogue/operate-a-pirogue/>Operate a PiRogue</a></li><li><a class="docs-link rounded" href=/docs/pirogue/cheatsheet/>Cheatsheet</a></li><li><a class="docs-link rounded" href=/docs/pirogue/useful-commands/>Useful commands</a></li><li><a class="docs-link rounded" href=/docs/pirogue/pre-installed-tools/>Pre-installed tools</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-0153a1e369e543364edb1e75ceff1173 aria-expanded=true>
Recipes</button><div class="collapse show" id=section-0153a1e369e543364edb1e75ceff1173><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=/docs/recipes/pirogue-without-ethernet-connection/>PiRogue without ethernet connection</a></li><li><a class="docs-link rounded" href=/docs/recipes/device-forensic-with-mvt/>Device forensic with MVT</a></li><li><a class="docs-link rounded" href=/docs/recipes/add-your-own-suricata-rules-to-pirogue/>Add your own suricata rules to PiRogue</a></li><li><a class="docs-link rounded" href=/docs/recipes/turn-a-regular-pc-into-a-pirogue/>Turn a regular PC into a PiRogue</a></li><li><a class="docs-link rounded active" href=/docs/recipes/how-to-intercept-and-decrypt-tls-traffic/>How to intercept and decrypt TLS traffic</a></li><li><a class="docs-link rounded" href=/docs/recipes/export-pirogue-data/>Export PiRogue data</a></li></ul></div></li></ul></nav></aside></div><div class="wrap container-fluid" role=document><div class=content><div class="row flex-xl-nowrap"><div class="col-lg-5 col-xl-4 docs-sidebar d-none d-lg-block"><nav class=docs-links aria-label="Main navigation"><ul class="list-unstyled collapsible-sidebar"><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-5f2cae171c6192fa410df4385f7218aa aria-expanded=false>
Prologue</button><div class=collapse id=section-5f2cae171c6192fa410df4385f7218aa><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=/docs/prologue/introduction/>Introduction</a></li><li><a class="docs-link rounded" href=/docs/prologue/quick-start/>Quick Start</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-156eb3d3f8417d06d51d14197a51282b aria-expanded=false>
The PiRogue</button><div class=collapse id=section-156eb3d3f8417d06d51d14197a51282b><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=/docs/pirogue/overview/>Overview</a></li><li><a class="docs-link rounded" href=/docs/pirogue/build-a-pirogue/>Build a PiRogue</a></li><li><a class="docs-link rounded" href=/docs/pirogue/build-a-pirogue-hat/>Build a PiRogue hat</a></li><li><a class="docs-link rounded" href=/docs/pirogue/build-a-pirogue-case/>Build a PiRogue case</a></li><li><a class="docs-link rounded" href=/docs/pirogue/configure-a-pirogue/>Configure a PiRogue</a></li><li><a class="docs-link rounded" href=/docs/pirogue/upgrade-a-pirogue/>Upgrade a PiRogue</a></li><li><a class="docs-link rounded" href=/docs/pirogue/operate-a-pirogue/>Operate a PiRogue</a></li><li><a class="docs-link rounded" href=/docs/pirogue/cheatsheet/>Cheatsheet</a></li><li><a class="docs-link rounded" href=/docs/pirogue/useful-commands/>Useful commands</a></li><li><a class="docs-link rounded" href=/docs/pirogue/pre-installed-tools/>Pre-installed tools</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-0153a1e369e543364edb1e75ceff1173 aria-expanded=true>
Recipes</button><div class="collapse show" id=section-0153a1e369e543364edb1e75ceff1173><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=/docs/recipes/pirogue-without-ethernet-connection/>PiRogue without ethernet connection</a></li><li><a class="docs-link rounded" href=/docs/recipes/device-forensic-with-mvt/>Device forensic with MVT</a></li><li><a class="docs-link rounded" href=/docs/recipes/add-your-own-suricata-rules-to-pirogue/>Add your own suricata rules to PiRogue</a></li><li><a class="docs-link rounded" href=/docs/recipes/turn-a-regular-pc-into-a-pirogue/>Turn a regular PC into a PiRogue</a></li><li><a class="docs-link rounded active" href=/docs/recipes/how-to-intercept-and-decrypt-tls-traffic/>How to intercept and decrypt TLS traffic</a></li><li><a class="docs-link rounded" href=/docs/recipes/export-pirogue-data/>Export PiRogue data</a></li></ul></div></li></ul></nav></div><nav class="docs-toc d-none d-xl-block col-xl-3" aria-label="Secondary navigation"><div class=page-links><h3>On this page</h3><nav id=TableOfContents><ul><li><ul><li><a href=#requirements>Requirements</a></li><li><a href=#procedure>Procedure</a><ul><li><a href=#identify-and-install-the-application>Identify and install the application</a></li><li><a href=#instrument-and-intercept>Instrument and intercept</a></li><li><a href=#decrypt-the-traffic>Decrypt the traffic</a></li></ul></li><li><a href=#generated-files>Generated files</a></li></ul></li></ul></nav></div></nav><main class="docs-content col-lg-11 col-xl-9"><h1>How to intercept and decrypt TLS traffic</h1><p class=lead></p><nav class=d-xl-none aria-label="Quaternary navigation"><div class=page-links><h3>On this page</h3><nav id=TableOfContents><ul><li><ul><li><a href=#requirements>Requirements</a></li><li><a href=#procedure>Procedure</a><ul><li><a href=#identify-and-install-the-application>Identify and install the application</a></li><li><a href=#instrument-and-intercept>Instrument and intercept</a></li><li><a href=#decrypt-the-traffic>Decrypt the traffic</a></li></ul></li><li><a href=#generated-files>Generated files</a></li></ul></li></ul></nav></div></nav><p>This recipe is dedicated to intrepid users 😎</p><p>PiRogue comes with a <code>pirogue-intercept-*</code> helpers to help you intercept encrypted TLS traffic from applications, even in presence of TLS certificate pinning.</p><p>These helpers are meant to:</p><ul><li>capture the network traffic</li><li>instrument a specific application or any launched application</li></ul><h2 id=requirements>Requirements <a href=#requirements class=anchor aria-hidden=true>#</a></h2><p>To follow this recipe, you need:</p><ul><li>an up-to-date PiRogue</li><li>a rooted Android device</li></ul><h2 id=procedure>Procedure <a href=#procedure class=anchor aria-hidden=true>#</a></h2><p>First, SSH onto your PiRogue. Attach your smartphone to the PiRogue through USB and make sure &ldquo;USB debugging&rdquo; is on and working.</p><p>Make sure to enable ADB <em>Transfer files</em> by clicking on the <em>Android System</em> notification.</p><center><video height=480 controls>
<source src=img/adb_config_out.mp4 type=video/mp4><source src=img/adb_config_out.webm type=video/webm>Your browser does not support the video tag.</video></center><p>Then check if the PiRogue <em>sees</em> your device by running the command:</p><pre tabindex=0><code>adb devices
</code></pre><p>You should see your device listed. If not, be sure to use the right USB cable for your device. If the issue remains, check that you have the rights to interact with USB devices. To do so, run the command <code>groups</code> to list the groups you belong to and check if the group <code>plugdev</code> is listed. If not, execute the following command <code>sudo usermod -aG plugdev $LOGNAME</code> and reboot.</p><h3 id=identify-and-install-the-application>Identify and install the application <a href=#identify-and-install-the-application class=anchor aria-hidden=true>#</a></h3><p>Android applications are identified by their <em>package name</em>. As an example, the French weather forecast application is <code>fr.meteo</code>. You can get the package name either from Google Play URL or from any tool analyzing Android apps such as <a href=https://beta.pithus.org>Pithus</a>, <a href=https://www.virustotal.com/gui/home/upload>Virus Total</a>, etc. In our example, the Google Play URL looks like <code>https://play.google.com/store/apps/details?id=fr.meteo</code>, the package name of the application is specified after <code>id=</code>.</p><p>Once you have identified the application you want to analyze, you have to download and install it on your target device. If you need to download the application from Google Play, we recommend to use <a href=https://github.com/EFForg/apkeep><code>apkeep</code></a> (not installed by default on PiRogue).</p><p>Finally, to install the application, run the following command:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>adb install &lt;APK file&gt;
</span></span></code></pre></div><p>If your application contains multiple APKs (like in XAPK), use the command <code>adb install-multiple &lt;list all apks></code>.</p><p>Don&rsquo;t launch the application.</p><h3 id=instrument-and-intercept>Instrument and intercept <a href=#instrument-and-intercept class=anchor aria-hidden=true>#</a></h3><p>Once the application to be analyzed is installed on your Android device, connect your device to the PiRogue Wi-Fi network and run the following command:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo pirogue-intercept-gated -o &lt;path to the output directory&gt;
</span></span></code></pre></div><p>Adapt the command according to your output directory of choice. Once started and showing <code>Waiting for data</code>, manually launch the application you want to analyze.</p><figure class=text-center><img class="img-fluid lazyload blur-up d-block mx-auto shadow" data-sizes=auto src=/docs/recipes/how-to-intercept-and-decrypt-tls-traffic/img/launch_hub582c82064322eb2bcb94175190a7bf6_71528_1800x0_resize_box_3.png data-srcset width=1360 height=312 alt="Command capturing TLS traffic"><noscript><img class="img-fluid d-block mx-auto shadow" sizes=100vw srcset src=/docs/recipes/how-to-intercept-and-decrypt-tls-traffic/img/launch.png width=1360 height=312 alt="Command capturing TLS traffic"></noscript></figure><p>Now, interact with the application freely. When you are done interacting with the app, hit <code>Ctrl</code>+<code>C</code> on your keyboard to stop interception.</p><div class="alert alert-doks d-flex" role=alert><div class="flex-shrink-1 alert-icon">⚠️</div><div class=w-100>Make sure that the application you want to be analyzed is not running in background. You can, for example, force stop it in <em>Settings > Apps</em>, select the application and click on <em>Stop</em>.</div></div><h3 id=decrypt-the-traffic>Decrypt the traffic <a href=#decrypt-the-traffic class=anchor aria-hidden=true>#</a></h3><p>If we run the previous command with <code>sudo</code>, we have to fix the permissions of generated files by running:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>chown -R pi:pi &lt;path to the output directory&gt;
</span></span></code></pre></div><p>Then enter the output directory with:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span> &lt;path to the output directory&gt;
</span></span></code></pre></div><figure class=text-center><img class="img-fluid lazyload blur-up d-block mx-auto shadow" data-sizes=auto src=/docs/recipes/how-to-intercept-and-decrypt-tls-traffic/img/permissions_hu56c44dc406775d9a7b7a274318721e55_48607_1800x0_resize_box_3.png data-srcset width=821 height=243 alt="Command fixing file permissions"><noscript><img class="img-fluid d-block mx-auto shadow" sizes=100vw srcset src=/docs/recipes/how-to-intercept-and-decrypt-tls-traffic/img/permissions.png width=821 height=243 alt="Command fixing file permissions"></noscript></figure><p>Next, we generate a PCAPNG file containing both the TLS keys and the captured traffic:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>editcap --inject-secrets tls,sslkeylog.txt traffic.pcap decrypted.pcapng
</span></span></code></pre></div><p>Next, we export the decrypted traffic in JSON:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>tshark -2 -T ek --enable-protocol communityid -Ndmn -r decrypted.pcapng &gt; traffic.json
</span></span></code></pre></div><figure class=text-center><img class="img-fluid lazyload blur-up d-block mx-auto shadow" data-sizes=auto src=/docs/recipes/how-to-intercept-and-decrypt-tls-traffic/img/decrypt_hu68aba39f36441a6927d28c54fa344322_79002_1800x0_resize_box_3.png data-srcset width=1687 height=306 alt="Command decrypting TLS traffic"><noscript><img class="img-fluid d-block mx-auto shadow" sizes=100vw srcset src=/docs/recipes/how-to-intercept-and-decrypt-tls-traffic/img/decrypt.png width=1687 height=306 alt="Command decrypting TLS traffic"></noscript></figure><p>Finally, to view the decrypted traffic, run:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>pirogue-view-tls -i traffic.json -t socket_trace.json
</span></span></code></pre></div><figure class=text-center><img class="img-fluid lazyload blur-up d-block mx-auto shadow" data-sizes=auto src=/docs/recipes/how-to-intercept-and-decrypt-tls-traffic/img/view+_hu918e11f098e4cee88f9b2fc71d97ba7c_131543_1800x0_resize_box_3.png data-srcset width=1412 height=933 alt="Command displaying TLS traffic"><noscript><img class="img-fluid d-block mx-auto shadow" sizes=100vw srcset src=/docs/recipes/how-to-intercept-and-decrypt-tls-traffic/img/view+.png width=1412 height=933 alt="Command displaying TLS traffic"></noscript></figure><div class="alert alert-doks d-flex" role=alert><div class="flex-shrink-1 alert-icon">⚠️</div><div class=w-100>The display of the stack trace has been added to <code>pirogue-cli</code> in version <code>1.0.5</code>. Be sure to upgrade your PiRogue.</div></div><p>If you face any issue, <a href=https://discord.gg/qGX73GYNdp>join the Discord channel</a> to get help.</p><h2 id=generated-files>Generated files <a href=#generated-files class=anchor aria-hidden=true>#</a></h2><p>The commands <code>pirogue-intercept-single</code> and <code>pirogue-intercept-gated</code> generate the following files:</p><ul><li><code>aes_info.json</code> contains all AES and RSA encryption/decryption operation with both cleartext and cyphertext</li><li><code>device.json</code> contains various information about the device such as IMEI, Android version</li><li><code>experiment.json</code> contains timing information such as the start and end date of the experiment</li><li><code>screen.mp4</code> contains the video recording of the device&rsquo;s screen</li><li><code>socket_trace.json</code> contains the stack trace of all operations on sockets (open, close, read, write&mldr;)</li><li><code>sslkeylog.txt</code> contains the TLS encryption keys in the <a href=https://firefox-source-docs.mozilla.org/security/nss/legacy/key_log_format/index.html>NSS key log format</a></li><li><code>traffic.pcap</code> contains the entire network traffic captured during the experiment</li></ul><p><strong>NB</strong>: you can open the PCAP file with Wireshark and specify the key log file in <em>Settings > Protocols > TLS</em>. This way, Wireshark will automatically decrypt TLS traffic.</p><div class="page-footer-meta d-flex flex-column flex-md-row justify-content-between"></div><div class="docs-navigation d-flex justify-content-between"><a href=/docs/recipes/turn-a-regular-pc-into-a-pirogue/><div class="card my-1"><div class="card-body py-2">&larr; Turn a regular PC into a PiRogue</div></div></a><a class=ms-auto href=/docs/recipes/export-pirogue-data/><div class="card my-1"><div class="card-body py-2">Export PiRogue data &rarr;</div></div></a></div></main></div></div></div><footer class="footer text-muted"><div class=container-xxl><div class=row><div class="col-lg-8 order-last order-lg-first"><ul class=list-inline><li class=list-inline-item></li></ul></div><div class="col-lg-8 order-first order-lg-last text-lg-end"><ul class=list-inline></ul></div></div></div></footer><script defer data-domain=pts-project.org src=https://plausible.io/js/script.js></script>
<script src=/js/bootstrap.min.8a4a3d8b214130d694b91942f330a0ec0c040217d0a2d422dd41c29176f49518f95cfb7846634f3b82e7fe358e0ba64b9b80263c759b07e85b7cc479c8875628.js integrity="sha512-iko9iyFBMNaUuRlC8zCg7AwEAhfQotQi3UHCkXb0lRj5XPt4RmNPO4Ln/jWOC6ZLm4AmPHWbB+hbfMR5yIdWKA==" crossorigin=anonymous defer></script>
<script src=/main.min.032f7f61db03165191ebf51143f7844840a639c8306d581472572d13d43b8a8d7bfa35f684782ab0505a3aa4bbf10089cc9501571550beea562134f6070752cb.js integrity="sha512-Ay9/YdsDFlGR6/URQ/eESECmOcgwbVgUclctE9Q7io17+jX2hHgqsFBaOqS78QCJzJUBVxVQvupWITT2BwdSyw==" crossorigin=anonymous defer></script>
<script src=/index.min.b4522cd51f8efd429d1c8520356fa88d132267cff1f879ab8bd162311d4d352ac6f4470aac557f95e916242e118a62d635c3be2eeb683e595e39642a20c17dae.js integrity="sha512-tFIs1R+O/UKdHIUgNW+ojRMiZ8/x+Hmri9FiMR1NNSrG9EcKrFV/lekWJC4RimLWNcO+LutoPlleOWQqIMF9rg==" crossorigin=anonymous defer></script></body></html>