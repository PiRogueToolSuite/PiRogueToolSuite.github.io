<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><script>(()=>{var t=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches,e=localStorage.getItem("theme");t&&e===null&&(localStorage.setItem("theme","dark"),document.documentElement.setAttribute("data-dark-mode","")),t&&e==="dark"&&document.documentElement.setAttribute("data-dark-mode",""),e==="dark"&&document.documentElement.setAttribute("data-dark-mode","")})()</script><link rel=stylesheet href=/main.8177d1b96dc5a0e850b7283565ee98c0258cc30f694273246bfc926ba2f2dc7ad8a2925b25bc74805f56685f35c6582683db7e43d5605a3998b97f3fc7c93d58.css integrity="sha512-gXfRuW3FoOhQtyg1Ze6YwCWMww9pQnMka/ySa6Ly3HrYopJbJbx0gF9WaF81xlgmg9t+Q9VgWjmYuX8/x8k9WA==" crossorigin=anonymous><noscript><style>img.lazyload{display:none}</style></noscript><meta name=robots content="index, follow"><meta name=googlebot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><meta name=bingbot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><title>Advanced guide - How to use Colander to analyze the network traffic of an app - PiRogue tool suite</title><meta name=description content="This guide will walk you through a step-by-step procedure, focusing on the decryption and analysis of network traffic intercepted using the PiRogue.
Objective # The primary objective of this guide is to provide a detailed walkthrough of the process involved in decrypting and analyzing network traffic from a mobile application intercepted with PiRogue. If you&amp;rsquo;re interested in intercepting TLS traffic of a mobile app, consider checking out our guide on using PTS for intercepting TLS traffic."><link rel=canonical href=/guides/g9/><meta property="og:locale" content="en_US"><meta property="og:type" content="article"><meta property="og:title" content="Advanced guide - How to use Colander to analyze the network traffic of an app"><meta property="og:description" content="This guide will walk you through a step-by-step procedure, focusing on the decryption and analysis of network traffic intercepted using the PiRogue.
Objective # The primary objective of this guide is to provide a detailed walkthrough of the process involved in decrypting and analyzing network traffic from a mobile application intercepted with PiRogue. If you&rsquo;re interested in intercepting TLS traffic of a mobile app, consider checking out our guide on using PTS for intercepting TLS traffic."><meta property="og:url" content="/guides/g9/"><meta property="og:site_name" content="PiRogue tool suite"><meta name=twitter:card content="summary_large_image"><meta name=twitter:site content="@PiRogueTools"><meta name=twitter:creator content="@u039b"><meta name=twitter:title content="Advanced guide - How to use Colander to analyze the network traffic of an app"><meta name=twitter:description content><meta name=twitter:card content="summary"><meta name=twitter:image:alt content="Advanced guide - How to use Colander to analyze the network traffic of an app"><script type=application/ld+json>{"@context":"https://schema.org","@graph":[{"@type":"Organization","@id":"/#/schema/organization/1","name":"PiRogue tool suite","url":"/","sameAs":["https://twitter.com/PiRogueTools","https://github.com/PiRogueToolSuite/"],"logo":{"@type":"ImageObject","@id":"/#/schema/image/1","url":"/android-chrome-512x512.png","width":512,"height":512,"caption":"PiRogue tool suite"},"image":{"@id":"/#/schema/image/1"}},{"@type":"WebSite","@id":"/#/schema/website/1","url":"/","name":"PiRogue tool suite","description":"PiRogue tool suite (PTS) is an open-source tool suite that provides a comprehensive mobile forensic and network traffic analysis platform targeting mobile devices both Android and iOS, internet of things devices (devices that are connected to the user mobile apps), and in general any device using wi-fi to connect to the Internet.","publisher":{"@id":"/#/schema/organization/1"}},{"@type":"WebPage","@id":"/guides/g9/","url":"/guides/g9/","name":"Advanced guide - How to use Colander to analyze the network traffic of an app","description":"","isPartOf":{"@id":"/#/schema/website/1"},"about":{"@id":"/#/schema/organization/1"},"datePublished":"0001-01-01T00:00:00CET","dateModified":"0001-01-01T00:00:00CET","breadcrumb":{"@id":"/guides/g9/#/schema/breadcrumb/1"},"primaryImageOfPage":{"@id":"/guides/g9/#/schema/image/2"},"inLanguage":"en-US","potentialAction":[{"@type":"ReadAction","target":["/guides/g9/"]}]},{"@type":"BreadcrumbList","@id":"/guides/g9/#/schema/breadcrumb/1","name":"Breadcrumbs","itemListElement":[{"@type":"ListItem","position":1,"item":{"@type":"WebPage","@id":"/","url":"/","name":"Home"}},{"@type":"ListItem","position":2,"item":{"@id":"/guidesg9/"}}]},{"@context":"https://schema.org","@graph":[{"@type":"ImageObject","@id":"/guides/g9/#/schema/image/2","url":null,"contentUrl":null,"caption":"Advanced guide - How to use Colander to analyze the network traffic of an app"}]}]}</script><meta name=theme-color content="#fff"><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest crossorigin=use-credentials href=/site.webmanifest></head><body class="guides single"><div class=header-bar></div><header class="navbar navbar-expand-md navbar-light doks-navbar"><nav class="container-xxl flex-wrap flex-md-nowrap" aria-label="Main navigation"><a class="navbar-brand p-0 me-auto" href=/ aria-label="PiRogue tool suite">PiRogue tool suite</a>
<button class="btn btn-menu d-block d-md-none order-5" type=button data-bs-toggle=offcanvas data-bs-target=#offcanvasDoks aria-controls=offcanvasDoks aria-label="Open main menu"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="18" x2="21" y2="18"/></svg></button><div class="offcanvas offcanvas-start border-0 py-md-1" tabindex=-1 id=offcanvasDoks data-bs-backdrop=true aria-labelledby=offcanvasDoksLabel><div class="header-bar d-md-none"></div><div class="offcanvas-header d-md-none"><h2 class="h5 offcanvas-title ps-2" id=offcanvasDoksLabel><a class=text-dark href=/>PiRogue tool suite</a></h2><button type=button class="btn-close text-reset me-2" data-bs-dismiss=offcanvas aria-label="Close main menu"></button></div><div class="offcanvas-body px-4"><h3 class="h6 text-uppercase mb-3 d-md-none">Main</h3><ul class="nav flex-column flex-md-row ms-md-n3"><li class=nav-item><a class="nav-link ps-0 py-1 active" href=/guides/>Guides</a></li><li class=nav-item><a class="nav-link ps-0 py-1" href=/docs/prologue/introduction/>Docs</a></li><li class=nav-item><a class="nav-link ps-0 py-1" href=/blog/>Blog</a></li><li class=nav-item><a class="nav-link ps-0 py-1" href=/contributors/>Contributors</a></li><li class=nav-item><a class="nav-link ps-0 py-1" href=/about/>About</a></li><li class=nav-item><a class="nav-link ps-0 py-1" href=/contact/>Contact</a></li></ul><hr class="text-black-50 my-4 d-md-none"><h3 class="h6 text-uppercase mb-3 d-md-none">Socials</h3><ul class="nav flex-column flex-md-row ms-md-auto me-md-n5 pe-md-2"><li class=nav-item><a class="nav-link ps-0 py-1" href=https://github.com/PiRogueToolSuite><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-github"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg><small class="ms-2 d-md-none">GitHub</small></a></li><li class=nav-item><a class="nav-link ps-0 py-1" href=https://twitter.com/PiRogueTools><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-twitter"><path d="M23 3a10.9 10.9.0 01-3.14 1.53 4.48 4.48.0 00-7.86 3v1A10.66 10.66.0 013 4s-4 9 5 13a11.64 11.64.0 01-7 2c9 5 20 0 20-11.5a4.5 4.5.0 00-.08-.83A7.72 7.72.0 0023 3z"/></svg><small class="ms-2 d-md-none">Twitter</small></a></li><li class=nav-item><a class="nav-link ps-0 py-1" href=https://discord.gg/qGX73GYNdp><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-message-square"><path d="M21 15a2 2 0 01-2 2H7l-4 4V5a2 2 0 012-2h14a2 2 0 012 2z"/></svg><small class="ms-2 d-md-none">Discord</small></a></li></ul></div></div><button id=mode class="btn btn-link order-md-1" type=button aria-label="Toggle user interface mode">
<span class=toggle-dark><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-moon"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg></span><span class=toggle-light><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-sun"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></span></button></nav></header><div class="wrap container-fluid" role=document><div class=content><div class="row justify-content-center flex-xl-nowrap"><nav class="docs-toc d-none d-xl-block col-xl-3" aria-label="Secondary navigation"><div class=page-links><h3>On this page</h3><nav id=TableOfContents><ul><li><a href=#objective>Objective</a></li><li><a href=#introduction>Introduction</a></li><li><a href=#on-hurry>On hurry?</a></li><li><a href=#mobile-apps-network-traffic-analysis>Mobile apps network traffic analysis</a><ul><li><a href=#different-types-of-data-collected-by-mobile-applications>Different types of data collected by mobile applications</a></li><li><a href=#writing-detection-rules-with-yara>Writing detection rules with Yara</a></li><li><a href=#analyzing-and-detecting-data-transmission>Analyzing and detecting data transmission</a></li></ul></li><li><a href=#network-traffic-analysis-in-colander>Network traffic analysis in Colander</a></li><li><a href=#analysis-procedure>Analysis procedure</a><ul><li><a href=#import-artifacts>Import artifacts</a></li><li><a href=#decrypt-the-network-traffic>Decrypt the network traffic</a></li><li><a href=#decode-payloads>Decode payloads</a></li><li><a href=#write-detection-rules>Write detection rules</a></li><li><a href=#generate-the-report>Generate the report</a></li></ul></li></ul></nav></div></nav><main class="docs-content col-lg-11 col-xl-9"><h1>Advanced guide - How to use Colander to analyze the network traffic of an app</h1><p><small>Posted by <a class="stretched-link position-relative" href=/contributors/esther-onfroy/>Esther Onfroy</a>&nbsp;&dash;&nbsp;<strong>16&nbsp;min read</strong></small><p><p class=lead></p><nav class=d-xl-none aria-label="Quaternary navigation"><div class=page-links><h3>On this page</h3><nav id=TableOfContents><ul><li><a href=#objective>Objective</a></li><li><a href=#introduction>Introduction</a></li><li><a href=#on-hurry>On hurry?</a></li><li><a href=#mobile-apps-network-traffic-analysis>Mobile apps network traffic analysis</a><ul><li><a href=#different-types-of-data-collected-by-mobile-applications>Different types of data collected by mobile applications</a></li><li><a href=#writing-detection-rules-with-yara>Writing detection rules with Yara</a></li><li><a href=#analyzing-and-detecting-data-transmission>Analyzing and detecting data transmission</a></li></ul></li><li><a href=#network-traffic-analysis-in-colander>Network traffic analysis in Colander</a></li><li><a href=#analysis-procedure>Analysis procedure</a><ul><li><a href=#import-artifacts>Import artifacts</a></li><li><a href=#decrypt-the-network-traffic>Decrypt the network traffic</a></li><li><a href=#decode-payloads>Decode payloads</a></li><li><a href=#write-detection-rules>Write detection rules</a></li><li><a href=#generate-the-report>Generate the report</a></li></ul></li></ul></nav></div></nav><p>This guide will walk you through a step-by-step procedure, focusing on the decryption and analysis of network traffic intercepted using the PiRogue.</p><h1 id=objective>Objective <a href=#objective class=anchor aria-hidden=true>#</a></h1><p>The primary objective of this guide is to provide a detailed walkthrough of the process involved in decrypting and analyzing network traffic from a mobile application intercepted with PiRogue. If you&rsquo;re interested in intercepting TLS traffic of a mobile app, consider checking out our guide on <a href=/guides/g8/>using PTS for intercepting TLS traffic</a>.</p><h1 id=introduction>Introduction <a href=#introduction class=anchor aria-hidden=true>#</a></h1><p>In the contemporary landscape of mobile applications, a clear understanding of network communication intricacies is essential for professionals in cybersecurity. This guide explores the functionalities of Colander, a tool designed for the decryption and analysis of network traffic from mobile applications. Throughout this tutorial, our aim is to provide insights into the dissection of network transmissions intercepted by the PiRogue. Mobile applications often conceal complex patterns within their network communications. Colander facilitates a detailed examination of this concealed realm.</p><p>This guide offers a roadmap for those exploring network traffic analysis. From transmission decryption to manual decoding and the formulation of detection rules, each section contributes to a practical understanding. Whether a seasoned analyst or an enthusiast, this journey aims to decipher the digital communication intricacies inherent in mobile applications using Colander.</p><h1 id=on-hurry>On hurry? <a href=#on-hurry class=anchor aria-hidden=true>#</a></h1><p>You are on hurry but can&rsquo;t remember the different commands to run on your PiRogue? Here they are:</p><ul><li>Instrument the mobile device: <code>pirogue-intercept-gated -o output</code></li><li>Wait until it says <code>Waiting for data</code> and start the application to be analyzed</li><li>Hit <code>Ctrl + C</code> when done with the app</li><li>Upload the experiment to Colander: <code>pirogue-colander collect-experiment -c "&lt;ID of your case>" output/</code></li><li>Upload an artifact to Colander: <code>pirogue-colander collect-artifact -c "&lt;ID of your case>" &lt;path of the file to be uploaded></code></li></ul><h1 id=mobile-apps-network-traffic-analysis>Mobile apps network traffic analysis <a href=#mobile-apps-network-traffic-analysis class=anchor aria-hidden=true>#</a></h1><h2 id=different-types-of-data-collected-by-mobile-applications>Different types of data collected by mobile applications <a href=#different-types-of-data-collected-by-mobile-applications class=anchor aria-hidden=true>#</a></h2><p>Mobile applications are integral components of contemporary digital ecosystems, acting as conduits for the acquisition and transmission of diverse data types. This section dissects the multifaceted nature of personal and sensitive information amassed by mobile applications, spanning realms such as identity, location, device characteristics, biometrics, usage patterns, communication, finance, health, social integration, and multimedia. Each data category unravels unique privacy concerns, emphasizing the paramount need for robust security frameworks and heightened user awareness in the digital landscape.</p><p><strong>Personal identifiable information (PII):</strong> Mobile applications routinely collect and process personal data, including full names, addresses, phone numbers, email addresses, social security numbers, passport details, driver&rsquo;s license information, and government-issued identification numbers. The vulnerability of such information to identity theft, fraud, and social engineering attacks heightens the importance of secure handling.</p><p><em>Example:</em> In the payload of an HTTP POST request, a snippet might appear as follows:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;user&#34;</span><span class=p>:</span> <span class=s2>&#34;JohnDoe&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;email&#34;</span><span class=p>:</span> <span class=s2>&#34;john.doe@email.com&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;password&#34;</span><span class=p>:</span> <span class=s2>&#34;hashed_password&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;address&#34;</span><span class=p>:</span> <span class=s2>&#34;123 Main St&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;phone&#34;</span><span class=p>:</span> <span class=s2>&#34;+1234567890&#34;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p><strong>Location data:</strong> GPS coordinates, Wi-Fi access points, cell tower information, historical location trails, frequently visited places, travel routes, and geofencing details constitute location data collected by mobile applications. The potential for unscrupulous tracking poses a direct threat to personal safety and breaches privacy boundaries.</p><p><em>Example:</em> A segment of a JSON payload within a POST request could resemble:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;latitude&#34;</span><span class=p>:</span> <span class=mf>37.7749</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;longitude&#34;</span><span class=p>:</span> <span class=mf>-122.4194</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;accuracy&#34;</span><span class=p>:</span> <span class=mi>10</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p><strong>Device information:</strong> Mobile applications gather an array of device-related details, encompassing device model, operating system version, unique device identifiers (IMEI or UDID), network information, device orientation, battery status, screen resolution, installed applications, and browser history. This data, when exposed, becomes a target for potential exploitation through targeted attacks.</p><p><em>Example:</em> Extracting device details from the user-agent string in an HTTP header:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-txt data-lang=txt><span class=line><span class=cl>User-Agent: Mozilla/5.0 (iPhone; CPU iPhone OS 15_0 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/15.0 Mobile/15E148 Safari/604.1
</span></span></code></pre></div><p><strong>Biometric data:</strong> Fingerprint scans, facial recognition data, voiceprints, retina scans, palm prints, gait analysis, keystroke dynamics, and vein patterns constitute the realm of biometric data collected by mobile applications. The compromise of such biometric information poses severe security threats, including unauthorized access and identity fraud.</p><p><em>Example:</em> A snippet from a JSON payload containing biometric information:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;fingerprint&#34;</span><span class=p>:</span> <span class=s2>&#34;SHA256_Hashed_Fingerprint&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;facial_data&#34;</span><span class=p>:</span> <span class=s2>&#34;Encrypted_Facial_Scan&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;voiceprint&#34;</span><span class=p>:</span> <span class=s2>&#34;Biometric_Voiceprint&#34;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p><strong>Usage patterns and analytics:</strong> Mobile applications meticulously track usage patterns, encompassing app usage statistics, session duration, feature interaction data, clickstream data, scroll patterns, time spent on specific features, and error logs. The malicious exploitation of usage patterns may lead to manipulative profiling or targeted attacks.</p><p><em>Example:</em> Portion of a payload containing app usage statistics:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;app_name&#34;</span><span class=p>:</span> <span class=s2>&#34;ExampleApp&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;session_duration&#34;</span><span class=p>:</span> <span class=mi>1800</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;feature_interaction&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;login&#34;</span><span class=p>:</span> <span class=mi>5</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;search&#34;</span><span class=p>:</span> <span class=mi>20</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;purchase&#34;</span><span class=p>:</span> <span class=mi>3</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p><strong>Communication data:</strong> Call logs, text messages, contact lists, voicemail transcripts, call duration patterns, contact relationship analysis, and email communication metadata fall within the ambit of communication data. Unauthorized access to such data raises concerns about privacy breaches, extortion, eavesdropping, or identity manipulation.</p><p><em>Example:</em> Extracting call logs from a payload:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;call_history&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span><span class=nt>&#34;contact&#34;</span><span class=p>:</span> <span class=s2>&#34;Alice&#34;</span><span class=p>,</span> <span class=nt>&#34;duration&#34;</span><span class=p>:</span> <span class=mi>120</span><span class=p>,</span> <span class=nt>&#34;timestamp&#34;</span><span class=p>:</span> <span class=s2>&#34;2024-01-01T10:30:00&#34;</span><span class=p>},</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span><span class=nt>&#34;contact&#34;</span><span class=p>:</span> <span class=s2>&#34;Bob&#34;</span><span class=p>,</span> <span class=nt>&#34;duration&#34;</span><span class=p>:</span> <span class=mi>60</span><span class=p>,</span> <span class=nt>&#34;timestamp&#34;</span><span class=p>:</span> <span class=s2>&#34;2024-01-02T15:45:00&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p><strong>Financial information:</strong> Credit card details, banking information, transaction history, investment portfolios, credit score information, loan application details, and cryptocurrency transaction history form the spectrum of financial information handled by mobile applications. Unauthorized extraction of financial data opens avenues for fraudulent activities, impacting individual financial security.</p><p><em>Example:</em> Segments of a payload containing financial data:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;credit_card&#34;</span><span class=p>:</span> <span class=s2>&#34;**** **** **** 1234&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;bank_account&#34;</span><span class=p>:</span> <span class=s2>&#34;123456789&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;transactions&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span><span class=nt>&#34;amount&#34;</span><span class=p>:</span> <span class=mf>50.00</span><span class=p>,</span> <span class=nt>&#34;vendor&#34;</span><span class=p>:</span> <span class=s2>&#34;OnlineStore&#34;</span><span class=p>,</span> <span class=nt>&#34;timestamp&#34;</span><span class=p>:</span> <span class=s2>&#34;2024-01-03T12:00:00&#34;</span><span class=p>},</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span><span class=nt>&#34;amount&#34;</span><span class=p>:</span> <span class=mf>20.00</span><span class=p>,</span> <span class=nt>&#34;vendor&#34;</span><span class=p>:</span> <span class=s2>&#34;CoffeeShop&#34;</span><span class=p>,</span> <span class=nt>&#34;timestamp&#34;</span><span class=p>:</span> <span class=s2>&#34;2024-01-04T08:30:00&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p><strong>Health and fitness data:</strong> Fitness tracking, heart rate monitoring, health-related information, sleep patterns, calorie intake logs, medication adherence records, and medical appointment history constitute health and fitness data collected by mobile applications. Exploiting such data may lead to targeted attacks, health-related scams, or manipulation of insurance claims.</p><p><em>Example:</em> An excerpt from a payload with health-related information:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;heart_rate&#34;</span><span class=p>:</span> <span class=mi>75</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;calories_burned&#34;</span><span class=p>:</span> <span class=mi>300</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;sleep_pattern&#34;</span><span class=p>:</span> <span class=p>{</span><span class=nt>&#34;start&#34;</span><span class=p>:</span> <span class=s2>&#34;2024-01-05T22:00:00&#34;</span><span class=p>,</span> <span class=nt>&#34;end&#34;</span><span class=p>:</span> <span class=s2>&#34;2024-01-06T06:00:00&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p><strong>Social media integration:</strong> The integration with social media platforms involves accessing profiles, friend lists, posts, direct messages, social connections&rsquo; activity logs, shared multimedia content, and engagement metrics. Unauthorized access raises concerns about identity impersonation, social engineering attacks, and manipulation of an individual&rsquo;s online presence.</p><p><em>Example:</em> Portion of a payload containing social media data:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;social_profile&#34;</span><span class=p>:</span> <span class=s2>&#34;Username123&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;friend_list&#34;</span><span class=p>:</span> <span class=p>[</span><span class=s2>&#34;Alice&#34;</span><span class=p>,</span> <span class=s2>&#34;Bob&#34;</span><span class=p>,</span> <span class=s2>&#34;Charlie&#34;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;posts&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span><span class=nt>&#34;content&#34;</span><span class=p>:</span> <span class=s2>&#34;Having a great day!&#34;</span><span class=p>,</span> <span class=nt>&#34;timestamp&#34;</span><span class=p>:</span> <span class=s2>&#34;2024-01-06T12:30:00&#34;</span><span class=p>},</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span><span class=nt>&#34;content&#34;</span><span class=p>:</span> <span class=s2>&#34;Exploring new places!&#34;</span><span class=p>,</span> <span class=nt>&#34;timestamp&#34;</span><span class=p>:</span> <span class=s2>&#34;2024-01-07T09:45:00&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p><strong>Camera and media files:</strong> Photos, videos, audio recordings, location metadata in photos, facial recognition data in images, audio recordings of ambient sounds, and video surveillance footage contribute to the category of camera and media files. Intrusion into personal media files compromises individual privacy and can lead to blackmail, extortion, or unauthorized use of personal content.</p><p><em>Example:</em> Extracting metadata from a photo&rsquo;s EXIF data:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;photo_metadata&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;location&#34;</span><span class=p>:</span> <span class=p>{</span><span class=nt>&#34;latitude&#34;</span><span class=p>:</span> <span class=mf>37.7749</span><span class=p>,</span> <span class=nt>&#34;longitude&#34;</span><span class=p>:</span> <span class=mf>-122.4194</span><span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;timestamp&#34;</span><span class=p>:</span> <span class=s2>&#34;2024-01-08T15:15:00&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;camera_model&#34;</span><span class=p>:</span> <span class=s2>&#34;SmartphoneModelX&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h2 id=writing-detection-rules-with-yara>Writing detection rules with Yara <a href=#writing-detection-rules-with-yara class=anchor aria-hidden=true>#</a></h2><p><a href=https://yara.readthedocs.io/en/stable/>Yara</a> stands as an open-source tool and scripting language designed for the detection and classification of malware and malicious activities. Yara serves as a powerful resource for security researchers, analysts, and incident responders, enabling the creation of custom rules for the identification of specific patterns within files, memory, or network traffic.</p><p><strong>Structure of a Typical Yara Rule:</strong>
The typical Yara rule structure consists of a set of conditions and associated actions, articulated in a human-readable format. These rules utilize patterns or characteristics for Yara to match against data. The anatomy of a Yara rule can be exemplified through an illustrative case:</p><p>In the example rule below, named &ldquo;Detect_PII&rdquo;:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-txt data-lang=txt><span class=line><span class=cl>rule Detect_PII {
</span></span><span class=line><span class=cl>    strings:
</span></span><span class=line><span class=cl>        $social_security = /\d{3}-\d{2}-\d{4}/
</span></span><span class=line><span class=cl>        $phone_number = /\+\d{1,2}\s?\(\d{3}\)\s?\d{3}-\d{4}/
</span></span><span class=line><span class=cl>    condition:
</span></span><span class=line><span class=cl>        $social_security or $phone_number
</span></span><span class=line><span class=cl>}
</span></span></code></pre></div><p>The rule unfolds in distinct sections. First, the &ldquo;strings&rdquo; section defines patterns or regular expressions, such as <code>$social_security</code> for Social Security Numbers and <code>$phone_number</code> for international phone numbers. The subsequent &ldquo;condition&rdquo; section specifies when the rule triggers – in this case, if either a Social Security Number or a phone number is found.</p><p>Another example, &ldquo;Detect_TLS_SSL&rdquo;, highlights the identification of TLS/SSL encryption in network traffic:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-txt data-lang=txt><span class=line><span class=cl>rule Detect_TLS_SSL {
</span></span><span class=line><span class=cl>    strings:
</span></span><span class=line><span class=cl>        $tls_version = /TLS\/\d\.\d/
</span></span><span class=line><span class=cl>    condition:
</span></span><span class=line><span class=cl>        $tls_version
</span></span><span class=line><span class=cl>}
</span></span></code></pre></div><p>This rule, named &ldquo;Detect_TLS_SSL&rdquo;, checks for the presence of TLS/SSL encryption through the definition of a string pattern, <code>$tls_version</code>, and a condition requiring its existence.</p><p><strong>Components of Yara Rules:</strong>
Each Yara rule comprises a rule name for identification, a strings section with defined patterns, and a condition section specifying the circumstances under which the rule triggers. Variables assigned in the strings section are referenced in the condition section, allowing for logical combinations.</p><p><strong>Additional Considerations:</strong>
Yara rules can incorporate metadata, providing details about the rule, such as authorship or references. The utilization of wildcards, quantifiers, and the ability to import rules into other rule sets enhances the flexibility and scalability of Yara in cybersecurity endeavors.</p><h2 id=analyzing-and-detecting-data-transmission>Analyzing and detecting data transmission <a href=#analyzing-and-detecting-data-transmission class=anchor aria-hidden=true>#</a></h2><p>Analyzing and detecting data transmissions within network traffic during the usage of mobile applications requires a systematic approach integrating tools, methodologies, and ethical considerations.</p><p><strong>API endpoint analysis:</strong> Reverse engineering the application unveils communication patterns with external servers. Analyzing API endpoints allows for correlating data transmission with distinct functionalities.</p><p><strong>Header information scrutiny:</strong> Inspection of HTTP headers provides valuable information, including device type, user-agent details, and content type. Headers offer insights into the nature of the transmitted data.</p><p><strong>Encryption protocol identification:</strong> Identifying encryption protocols and cipher suites used in data transmissions involves analyzing the TLS handshake and SSL/TLS certificates exchanged. This sheds light on the level of security applied to transmitted data.</p><p><strong>Frequency and volume analysis:</strong> Quantitative analysis of data exchange patterns, considering factors such as high frequency or large volume, may indicate specific data types, including media files or analytics data.</p><p><strong>Data compression analysis:</strong> Identification of data compression methods used in transmissions involves analyzing payload structure or headers. Recognition of compression algorithms enhances understanding.</p><p><strong>Use of specific ports:</strong> Analyzing port usage in network traffic provides clues about the types of data transmitted. Different data may use specific ports, aiding in categorization.</p><p><strong>Payload size patterns:</strong> Cluster analysis of payload sizes helps identify patterns. Distinctive payload sizes may be indicative of specific data types.</p><p><strong>Sequence and timing analysis:</strong> Correlating the timing of data transmissions with user interactions offers context. Temporal patterns reveal periodic or event-triggered data exchanges.</p><p><strong>Behavioral analysis:</strong> Mapping user actions to corresponding data transmissions aids in understanding context. Knowing when data is transmitted, such as during file uploads or messaging, enhances interpretation.</p><p><strong>Yara rules for data detection:</strong> Crafting Yara rules based on patterns indicative of specific data types automates the analysis process. Yara rules can be created and refined for detecting various data, such as PII.</p><p><strong>Applying Yara rules to network traffic:</strong> Utilizing Yara automates the application of rules to captured network traffic.</p><p><strong>Analyzing matches and refining rules:</strong> Reviewing Yara output identifies matches. Refining rules based on false positives or negatives improves accuracy.</p><p><strong>Iterative improvement:</strong> Regularly revisiting and refining Yara rules is imperative to adapt to changes in application behaviors and evolving data transmission methods.</p><p><strong>Ethical considerations:</strong> Ensuring all analyses are conducted ethically, in compliance with your internal guidelines and with user&rsquo;s consent is paramount.</p><h1 id=network-traffic-analysis-in-colander>Network traffic analysis in Colander <a href=#network-traffic-analysis-in-colander class=anchor aria-hidden=true>#</a></h1><p>Colander implements a graphical interface dedicated to traffic decryption, decoding and analysis of each network transmission. The purpose of this interface is to display information related to the network traffic as well as information related to the execution of the analyzed application. More precisely, this interface shows what part of an application was in charge of each network transmission.</p><figure class=text-center><img class="img-fluid lazyload blur-up d-block mx-auto shadow" data-sizes=auto src=/guides/g9/img/decrypted_traffic_hu16a9c808d8d2a9ce5754b37256424bfa_183992_1800x0_resize_box_3.png data-srcset width=1487 height=843 alt="Example of decrypted network transmission"><noscript><img class="img-fluid d-block mx-auto shadow" sizes=100vw srcset src=/guides/g9/img/decrypted_traffic.png width=1487 height=843 alt="Example of decrypted network transmission"></noscript><figcaption class=figure-caption><i>Example of decrypted network transmission</i></figcaption></figure><p>The interface of each network transmission is composed of the following sections:</p><ol><li>summary of the transmission listing:<ul><li>the direction of the transmission, either inbound or outbound</li><li>the layer-7 protocol</li><li>the amount of data sent or received</li><li>the source and destination IP addresses (and their name resolution)</li></ul></li><li>Exodus Privacy analysis of the stack trace listing:<ul><li>the name of the detected SDK, nothing otherwise</li><li>the purposes of the detected SDK</li></ul></li><li>list of detection rules matching on the current transmission</li><li><em>geoip</em> information of the remote server listing:<ul><li>the Community ID of the flow</li><li>the ASN and its block of IPs</li><li>the organization</li><li>the country</li></ul></li><li>Android process information listing:<ul><li>the timestamp of the termination of the transmission</li><li>the Android process name (usually the package name of the application)</li><li>the ID of the process</li><li>the ID of the thread</li><li>the ID of the socket</li></ul></li><li>headers of the HTTP request, empty otherwise</li><li>stack trace indicating what part of the application was in charge of the corresponding socket operations</li><li>indicates if the transmitted data/payload has been encrypted before transmission or not</li><li>controls on the data/payload allowing to:<ul><li>view the raw data (encoded in hex) or the decrypted data (if encrypted before transmission)</li><li>send to CyberChef the raw data (encoded in hex) or the decrypted data (if encrypted before transmission)</li><li>import manually decoded data/payload/content</li></ul></li><li>decoded transmitted data</li></ol><h1 id=analysis-procedure>Analysis procedure <a href=#analysis-procedure class=anchor aria-hidden=true>#</a></h1><h2 id=import-artifacts>Import artifacts <a href=#import-artifacts class=anchor aria-hidden=true>#</a></h2><p>The first step is to import the artifacts generated by the PiRogue into Colander.</p><p>If it is the first time you are using PiRogue in combination with Colander, you have to link your PiRogue to your Colander account. To do so, in Colander, click on your username at the top-right of the interface and find the exact command you must execute on your PiRogue.</p><p>This command looks like:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>pirogue-colander config -u <span class=s2>&#34;&lt;URL for your Colander server&gt;&#34;</span> -k <span class=s2>&#34;&lt;your API key&gt;&#34;</span>
</span></span></code></pre></div><p>This command will configure the connector for Colander.</p><p>If the command <code>pirogue-colander</code> is not found, install the package <code>pirogue-colander-connector</code> by running the following commands on your PiRogue:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo apt update
</span></span><span class=line><span class=cl>sudo apt install -y pirogue-colander-connector
</span></span></code></pre></div><p>This will update the list of available packages and install the necessary tools to connect your PiRogue to Colander.</p><p>Once the Colander connector is configured, use the <code>pirogue-colander</code> command to upload all the files generated during the instrumentation and execution of the mobile app. The commands <code>pirogue-intercept-single</code> and <code>pirogue-intercept-gated</code> generate various files stored in the folder of your choice.</p><p>As a reminder, here is the typical content of the output folder:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>output/
</span></span><span class=line><span class=cl>|-- ad_ids.txt
</span></span><span class=line><span class=cl>|-- aes_info.json
</span></span><span class=line><span class=cl>|-- device.json
</span></span><span class=line><span class=cl>|-- experiment.json
</span></span><span class=line><span class=cl>|-- screen.mp4
</span></span><span class=line><span class=cl>|-- socket_trace.json
</span></span><span class=line><span class=cl>|-- sslkeylog.txt
</span></span><span class=line><span class=cl>`-- traffic.pcap
</span></span></code></pre></div><p>The command <code>pirogue-colander</code> uses the file <code>experiment.json</code> to determine the different files to be uploaded to Colander. In Colander, select or create the case you want to upload these artifacts into and click on <em>Collect / PiRogue experiment</em>. At the bottom of the PiRogue experiment creation form, you will find a command to be executed on your PiRogue.</p><p>This command looks like:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>pirogue-colander collect-experiment -c <span class=s2>&#34;&lt;ID of your case&gt;&#34;</span> &lt;path of the folder containing your experiment&gt;
</span></span></code></pre></div><p>If you want to upload the APK or XAPK file corresponding you have used to install the app, specify its path in the <code>-t</code> parameter:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>pirogue-colander collect-experiment -c <span class=s2>&#34;&lt;ID of your case&gt;&#34;</span> -t &lt;path to the APK or XAPK file&gt; &lt;path of the folder containing your experiment&gt;
</span></span></code></pre></div><p>The command <code>pirogue-colander collect-experiment</code> will automatically upload all the files to Colander and create a new PiRogue experiment with the name you provided when asked.</p><p>As an example, if the folder containing generated files is located at <code>my_experiment/output</code> and the APK at <code>my_experiment/my_app.apk</code>, the command to run on the PiRogue looks like:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>pirogue-colander collect-experiment -c <span class=s2>&#34;&lt;ID of your case&gt;&#34;</span> -t my_experiment/my_app.apk my_experiment/output
</span></span></code></pre></div><p>This command will ask for the name of the experiment and, if you specified an (X)APK file, it will ask you to choose a type for this artifact, select <code>Android sample</code>. After completion, go back in Colander, in the <em>Collect</em> workspace, select <em>PiRogue experiment</em> and check the details of the newly created one.</p><p>If you want to upload other artifacts stored on your PiRogue, use the command:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>pirogue-colander collect-artifact -c <span class=s2>&#34;&lt;ID of your case&gt;&#34;</span> &lt;path of the file to be uploaded&gt;
</span></span></code></pre></div><p>You can find this command listed in Colander <em>Collect / Artifact</em> at the bottom of the artifact creation form.</p><figure class=text-center><img class="img-fluid lazyload blur-up d-block mx-auto shadow" data-sizes=auto src=/guides/g9/img/experiment_graph_hu4321abb379a34a268e62e756ba69dbb7_115467_1800x0_resize_box_3.png data-srcset width=1310 height=635 alt="Graph representation of a PiRogue experiment uploaded to Colander"><noscript><img class="img-fluid d-block mx-auto shadow" sizes=100vw srcset src=/guides/g9/img/experiment_graph.png width=1310 height=635 alt="Graph representation of a PiRogue experiment uploaded to Colander"></noscript><figcaption class=figure-caption><i>Graph representation of a PiRogue experiment uploaded to Colander</i></figcaption></figure><h2 id=decrypt-the-network-traffic>Decrypt the network traffic <a href=#decrypt-the-network-traffic class=anchor aria-hidden=true>#</a></h2><p>In Colander, open the details of your newly created PiRogue experiment and click on the button <em>Decrypt</em>. This will start the automatic traffic decryption in background, this could take a few minutes depending on the amount of traffic.</p><p>Colander will be using the PCAP file <code>traffic.pcap</code> and the file <code>sslkeylog.txt</code> to decrypt the network traffic. Once decrypted, Colander will do the automatic enrichment. First, based on the <a href=https://github.com/corelight/community-id-spec>Community ID</a> and time correlation, it will attach to each network flow the corresponding stack trace read from the file <code>socket_trace.json</code>. Each stack trace is then analyzed using <a href=https://exodus-privacy.eu.org/>Exodus Privacy</a> detection rules to detect the SDK potentially involved in the transmission. Then, by comparing the raw payloads read from the decrypted traffic and the <code>in</code> and <code>out</code> payloads read from the file <code>aes_info.json</code> containing all cryptographic operations (not only AES), Colander will attach the corresponding cleartext. The purpose here is to decrypt payloads that were encrypted before being sent over TLS. Finally, ElasticSearch will automatically attach to each network flow the corresponding <em>geoip</em> information such as the country and the organization of the remote server.</p><p>After few minutes, refresh the page listing details of your experiment, you should see the decrypted traffic.</p><h2 id=decode-payloads>Decode payloads <a href=#decode-payloads class=anchor aria-hidden=true>#</a></h2><p>The next step is to go through all network transmissions and manually decode the data/payload/content that has not been automatically decoded. To make easier for you, Colander can <em>send</em> the raw data (encoded in hex) or the decrypted data (if encrypted before transmission) to CyberChef. By default, the data is encoded in hexadecimal.</p><p>Write your recipe and once you are happy with its result, copy it, go back in Colander, click on <em>Import decoded content</em>, paste the output of your recipe and click on <em>Save</em>. Keep in mind that the detection rules will be applied on the decoded content your imported.</p><p>In some cases, Colander is not capable of identifying payloads that have been encrypted before been transmitted. If you encounter a payload you are not able to decode or you suspect it is encrypted, check the content of the file <code>aes_info.json</code> you uploaded at the first step of this guide.</p><h2 id=write-detection-rules>Write detection rules <a href=#write-detection-rules class=anchor aria-hidden=true>#</a></h2><p>Once you have decoded all the transmissions, it is time for you to write your Yara detection rules. To do so, in <em>Collect / Detection rules</em> create a new Yara rule. You can declare as many rules as you want in the <em>Content</em> section. All the Yara rules you have added to your case will be applied on:</p><ul><li>the URL/URI</li><li>the HTTP headers</li><li>the HTTP decoded payload</li></ul><p>As an example, here follows are 2 simple rules detecting the model and the brand of the mobile device:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-txt data-lang=txt><span class=line><span class=cl>rule device_model
</span></span><span class=line><span class=cl>{
</span></span><span class=line><span class=cl>  strings:
</span></span><span class=line><span class=cl>    $s = &#34;SM-G965F&#34; nocase
</span></span><span class=line><span class=cl> condition:
</span></span><span class=line><span class=cl>    $s
</span></span><span class=line><span class=cl>}
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>rule device_brand
</span></span><span class=line><span class=cl>{
</span></span><span class=line><span class=cl>  strings:
</span></span><span class=line><span class=cl>    $s = &#34;samsung&#34; nocase
</span></span><span class=line><span class=cl> condition:
</span></span><span class=line><span class=cl>    $s
</span></span><span class=line><span class=cl>}
</span></span></code></pre></div><p>Once you are happy if your detection rules, in the details of your PiRogue experiment, click on <em>Detect</em>. It will automatically apply all your rules.</p><p>Please note you have to reapply your detection rules each time you modify them. Changes on the detection rules are not automatically taken into account.</p><h2 id=generate-the-report>Generate the report <a href=#generate-the-report class=anchor aria-hidden=true>#</a></h2><p>When comes the time to generate the detection report, in the details of your PiRogue experiment, click on <em>View report</em>. It will open in another tab and you can use the <em>print</em> functionality of your web browser to save it as PDF.</p><p>This report contains:</p><ul><li>all artifacts such as PCAP file containing traffic data or screen recording and their digital signatures</li><li>the definition of the detection rules and the detection summary</li><li>the list of all transmissions listing the source and destination host, IP address and organization, the technical part of the application that has been handling the given data transmission (internal application code or 3rd-party SDKs)</li><li>the identification and classification of the transmitted data such as advertising ID, location data etc.</li><li>when applicable, the inferred purpose (such as analytics or advertisement) of the data collection using <a href=https://exodus-privacy.eu.org/>Exodus Privacy</a> tracker classification to identify the recipient company</li></ul><p>Colander analysis and detection accuracy can be assessed by opening the PCAP file and the SSL keylog file in Wireshark and manually verifying each data transmission.</p><div class="page-footer-meta d-flex flex-column flex-md-row justify-content-between"></div></main></div></div></div><footer class="footer text-muted"><div class=container-xxl><div class=row><div class="col-lg-8 order-last order-lg-first"><ul class=list-inline><li class=list-inline-item></li></ul></div><div class="col-lg-8 order-first order-lg-last text-lg-end"><ul class=list-inline></ul></div></div></div></footer><script defer data-domain=pts-project.org src=https://plausible.io/js/script.js></script>
<script src=/js/bootstrap.min.8a4a3d8b214130d694b91942f330a0ec0c040217d0a2d422dd41c29176f49518f95cfb7846634f3b82e7fe358e0ba64b9b80263c759b07e85b7cc479c8875628.js integrity="sha512-iko9iyFBMNaUuRlC8zCg7AwEAhfQotQi3UHCkXb0lRj5XPt4RmNPO4Ln/jWOC6ZLm4AmPHWbB+hbfMR5yIdWKA==" crossorigin=anonymous defer></script>
<script src=/main.min.032f7f61db03165191ebf51143f7844840a639c8306d581472572d13d43b8a8d7bfa35f684782ab0505a3aa4bbf10089cc9501571550beea562134f6070752cb.js integrity="sha512-Ay9/YdsDFlGR6/URQ/eESECmOcgwbVgUclctE9Q7io17+jX2hHgqsFBaOqS78QCJzJUBVxVQvupWITT2BwdSyw==" crossorigin=anonymous defer></script></body></html>