<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><script>(()=>{var t=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches,e=localStorage.getItem("theme");t&&e===null&&(localStorage.setItem("theme","dark"),document.documentElement.setAttribute("data-dark-mode","")),t&&e==="dark"&&document.documentElement.setAttribute("data-dark-mode",""),e==="dark"&&document.documentElement.setAttribute("data-dark-mode","")})()</script><link rel=stylesheet href=/main.4afba82c84ce5495177d6914104a204022e72fe906b28a0c7328e6153cd1975127496a1929b40f5f3aca1d452da8915340b3f1e5ada2ff5b4a6f879ebaa265e9.css integrity="sha512-SvuoLITOVJUXfWkUEEogQCLnL+kGsooMcyjmFTzRl1EnSWoZKbQPXzrKHUUtqJFTQLPx5a2i/1tKb4eeuqJl6Q==" crossorigin=anonymous><noscript><style>img.lazyload{display:none}</style></noscript><meta name=robots content="index, follow"><meta name=googlebot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><meta name=bingbot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><title>Intermediate guide - How to use MVT to conduct the analysis of a mobile device and its backup image - PiRogue tool suite</title><meta name=description content="The Mobile Verification Toolkit (MVT) developed by Amnesty International&amp;rsquo;s Security Lab is not a magic tool. This is a complex forensic framework designed to delve into the internals of Android and iOS devices, meticulously dissecting digital traces in search of malicious activities such as spyware.
It is imperative to emphasize that MVT is not intended for casual, self-directed investigation. It is not, by any means, a consumer-grade tool designed for recreational purposes, a personal &amp;ldquo;spyware detection&amp;rdquo; tool like the ones commonly distributed through mobile app stores."><link rel=canonical href=/guides/g7/><meta property="og:locale" content="en_US"><meta property="og:type" content="article"><meta property="og:title" content="Intermediate guide - How to use MVT to conduct the analysis of a mobile device and its backup image"><meta property="og:description" content="The Mobile Verification Toolkit (MVT) developed by Amnesty International&rsquo;s Security Lab is not a magic tool. This is a complex forensic framework designed to delve into the internals of Android and iOS devices, meticulously dissecting digital traces in search of malicious activities such as spyware.
It is imperative to emphasize that MVT is not intended for casual, self-directed investigation. It is not, by any means, a consumer-grade tool designed for recreational purposes, a personal &ldquo;spyware detection&rdquo; tool like the ones commonly distributed through mobile app stores."><meta property="og:url" content="/guides/g7/"><meta property="og:site_name" content="PiRogue tool suite"><meta name=twitter:card content="summary_large_image"><meta name=twitter:site content="@PiRogueTools"><meta name=twitter:creator content="@u039b"><meta name=twitter:title content="Intermediate guide - How to use MVT to conduct the analysis of a mobile device and its backup image"><meta name=twitter:description content><meta name=twitter:card content="summary"><meta name=twitter:image:alt content="Intermediate guide - How to use MVT to conduct the analysis of a mobile device and its backup image"><script type=application/ld+json>{"@context":"https://schema.org","@graph":[{"@type":"Organization","@id":"/#/schema/organization/1","name":"PiRogue tool suite","url":"/","sameAs":["https://twitter.com/PiRogueTools","https://github.com/PiRogueToolSuite/"],"logo":{"@type":"ImageObject","@id":"/#/schema/image/1","url":"/android-chrome-512x512.png","width":512,"height":512,"caption":"PiRogue tool suite"},"image":{"@id":"/#/schema/image/1"}},{"@type":"WebSite","@id":"/#/schema/website/1","url":"/","name":"PiRogue tool suite","description":"PiRogue tool suite (PTS) is an open-source tool suite that provides a comprehensive mobile forensic and network traffic analysis platform targeting mobile devices both Android and iOS, internet of things devices (devices that are connected to the user mobile apps), and in general any device using wi-fi to connect to the Internet.","publisher":{"@id":"/#/schema/organization/1"}},{"@type":"WebPage","@id":"/guides/g7/","url":"/guides/g7/","name":"Intermediate guide - How to use MVT to conduct the analysis of a mobile device and its backup image","description":"","isPartOf":{"@id":"/#/schema/website/1"},"about":{"@id":"/#/schema/organization/1"},"datePublished":"0001-01-01T00:00:00CET","dateModified":"0001-01-01T00:00:00CET","breadcrumb":{"@id":"/guides/g7/#/schema/breadcrumb/1"},"primaryImageOfPage":{"@id":"/guides/g7/#/schema/image/2"},"inLanguage":"en-US","potentialAction":[{"@type":"ReadAction","target":["/guides/g7/"]}]},{"@type":"BreadcrumbList","@id":"/guides/g7/#/schema/breadcrumb/1","name":"Breadcrumbs","itemListElement":[{"@type":"ListItem","position":1,"item":{"@type":"WebPage","@id":"/","url":"/","name":"Home"}},{"@type":"ListItem","position":2,"item":{"@id":"/guidesg7/"}}]},{"@context":"https://schema.org","@graph":[{"@type":"ImageObject","@id":"/guides/g7/#/schema/image/2","url":null,"contentUrl":null,"caption":"Intermediate guide - How to use MVT to conduct the analysis of a mobile device and its backup image"}]}]}</script><meta name=theme-color content="#fff"><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest crossorigin=use-credentials href=/site.webmanifest></head><body class="guides single"><div class=header-bar></div><header class="navbar navbar-expand-md navbar-light doks-navbar"><nav class="container-xxl flex-wrap flex-md-nowrap" aria-label="Main navigation"><a class="navbar-brand p-0 me-auto" href=/ aria-label="PiRogue tool suite">PiRogue tool suite</a>
<button class="btn btn-menu d-block d-md-none order-5" type=button data-bs-toggle=offcanvas data-bs-target=#offcanvasDoks aria-controls=offcanvasDoks aria-label="Open main menu"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="18" x2="21" y2="18"/></svg></button><div class="offcanvas offcanvas-start border-0 py-md-1" tabindex=-1 id=offcanvasDoks data-bs-backdrop=true aria-labelledby=offcanvasDoksLabel><div class="header-bar d-md-none"></div><div class="offcanvas-header d-md-none"><h2 class="h5 offcanvas-title ps-2" id=offcanvasDoksLabel><a class=text-dark href=/>PiRogue tool suite</a></h2><button type=button class="btn-close text-reset me-2" data-bs-dismiss=offcanvas aria-label="Close main menu"></button></div><div class="offcanvas-body px-4"><h3 class="h6 text-uppercase mb-3 d-md-none">Main</h3><ul class="nav flex-column flex-md-row ms-md-n3"><li class=nav-item><a class="nav-link ps-0 py-1 active" href=/guides/>Guides</a></li><li class=nav-item><a class="nav-link ps-0 py-1" href=/docs/prologue/introduction/>Docs</a></li><li class=nav-item><a class="nav-link ps-0 py-1" href=/blog/>Blog</a></li><li class=nav-item><a class="nav-link ps-0 py-1" href=/contributors/>Contributors</a></li><li class=nav-item><a class="nav-link ps-0 py-1" href=/about/>About</a></li><li class=nav-item><a class="nav-link ps-0 py-1" href=/contact/>Contact</a></li></ul><hr class="text-black-50 my-4 d-md-none"><h3 class="h6 text-uppercase mb-3 d-md-none">Socials</h3><ul class="nav flex-column flex-md-row ms-md-auto me-md-n5 pe-md-2"><li class=nav-item><a class="nav-link ps-0 py-1" href=https://github.com/PiRogueToolSuite><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-github"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg><small class="ms-2 d-md-none">GitHub</small></a></li><li class=nav-item><a class="nav-link ps-0 py-1" href=https://twitter.com/PiRogueTools><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-twitter"><path d="M23 3a10.9 10.9.0 01-3.14 1.53 4.48 4.48.0 00-7.86 3v1A10.66 10.66.0 013 4s-4 9 5 13a11.64 11.64.0 01-7 2c9 5 20 0 20-11.5a4.5 4.5.0 00-.08-.83A7.72 7.72.0 0023 3z"/></svg><small class="ms-2 d-md-none">Twitter</small></a></li><li class=nav-item><a class="nav-link ps-0 py-1" href=https://discord.gg/qGX73GYNdp><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-message-square"><path d="M21 15a2 2 0 01-2 2H7l-4 4V5a2 2 0 012-2h14a2 2 0 012 2z"/></svg><small class="ms-2 d-md-none">Discord</small></a></li></ul></div></div><button id=mode class="btn btn-link order-md-1" type=button aria-label="Toggle user interface mode">
<span class=toggle-dark><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-moon"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg></span><span class=toggle-light><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-sun"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></span></button></nav></header><div class="wrap container-fluid" role=document><div class=content><div class="row justify-content-center flex-xl-nowrap"><nav class="docs-toc d-none d-xl-block col-xl-3" aria-label="Secondary navigation"><div class=page-links><h3>On this page</h3><nav id=TableOfContents><ul><li><ul><li><a href=#strong-expertise-required>Strong expertise required</a></li><li><a href=#consensual-mobile-device-forensic>Consensual mobile device forensic</a></li><li><a href=#mvt-and-colander>MVT and Colander</a></li><li><a href=#overview-of-the-analysis-of-an-ios-device>Overview of the analysis of an iOS device</a></li><li><a href=#overview-of-the-analysis-of-an-android-device>Overview of the analysis of an Android device</a></li></ul></li></ul></nav></div></nav><main class="docs-content col-lg-11 col-xl-9"><h1>Intermediate guide - How to use MVT to conduct the analysis of a mobile device and its backup image</h1><p><small>Posted by <a class="stretched-link position-relative" href=/contributors/esther-onfroy/>Esther Onfroy</a>&nbsp;&dash;&nbsp;<strong>6&nbsp;min read</strong></small><p><p class=lead></p><nav class=d-xl-none aria-label="Quaternary navigation"><div class=page-links><h3>On this page</h3><nav id=TableOfContents><ul><li><ul><li><a href=#strong-expertise-required>Strong expertise required</a></li><li><a href=#consensual-mobile-device-forensic>Consensual mobile device forensic</a></li><li><a href=#mvt-and-colander>MVT and Colander</a></li><li><a href=#overview-of-the-analysis-of-an-ios-device>Overview of the analysis of an iOS device</a></li><li><a href=#overview-of-the-analysis-of-an-android-device>Overview of the analysis of an Android device</a></li></ul></li></ul></nav></div></nav><p>The <a href=https://docs.mvt.re>Mobile Verification Toolkit (MVT)</a> developed by <a href=https://securitylab.amnesty.org/>Amnesty International&rsquo;s Security Lab</a> is not a magic tool. This is a complex forensic framework designed to delve into the internals of Android and iOS devices, meticulously dissecting digital traces in search of malicious activities such as spyware.</p><p>It is imperative to emphasize that MVT is not intended for casual, self-directed investigation. It is not, by any means, a consumer-grade tool designed for recreational purposes, a personal &ldquo;spyware detection&rdquo; tool like the ones commonly distributed through mobile app stores. Utilizing MVT necessitates a profound understanding of both the underlying technical complexities and operational procedures associated with mobile device forensics. Such expertise significantly exceeds the capabilities of the average user.</p><div class="alert alert-warning d-flex" role=alert><div class="flex-shrink-1 alert-icon">⚠️</div><div class=w-100><strong>This guide provides a quick overview of what MVT is. If you are planning to use MVT, always refer to its official documentation: <a href=https://docs.mvt.re>https://docs.mvt.re</a></strong></div></div><h2 id=strong-expertise-required>Strong expertise required <a href=#strong-expertise-required class=anchor aria-hidden=true>#</a></h2><p>Interpreting MVT&rsquo;s findings requires navigating a labyrinth of digital forensics, data acquisition, and mobile device intricacies. Misinterpretations, like mistaking a harmless file for a threat, can lead to unnecessary panic and potentially corrupt crucial data. MVT delves deep, accessing sensitive information on your device. Using it haphazardly could inadvertently expose more than intended, putting your privacy at risk and potentially revealing information that would benefit malicious actors. Using MVT without proper knowledge could lead to accidental data corruption, adding to the problems instead of solving them.</p><p>MVT is designed for highly trained professionals, These individuals possess the deep understanding and experience to meticulously analyze data, interpret findings, and ensure accurate results. Their expertise lies in the nuances of Android and iOS systems, allowing them to extract meaningful insights from the device&rsquo;s digital traces. With knowledge of current malware threats and their signatures (Indicators of Compromise or IOCs), they can accurately interpret MVT&rsquo;s outputs and tailor the analysis to target specific threats with laser focus.</p><p>MVT is a powerful tool for trained professionals, not a magic wand for self-diagnosis. While its potential to uncover hidden threats and protect privacy is undeniable, it requires specialized expertise and responsible use.</p><h2 id=consensual-mobile-device-forensic>Consensual mobile device forensic <a href=#consensual-mobile-device-forensic class=anchor aria-hidden=true>#</a></h2><p>Consensual mobile device forensic analysis is the process of examining a mobile device with the owner&rsquo;s consent to identify signs of compromise or active spying. This involves analyzing data stored on the device, such as call logs, text messages, and browsing history, as well as examining installed apps and system configurations. The goal is to uncover any unauthorized access, surveillance activities, or malicious software that may be compromising the device&rsquo;s security and privacy. This process is often used by cybersecurity professionals, law enforcement agencies, and private investigators to gather evidence of digital intrusions or targeted attacks.</p><p>The PiRogue comes with MVT pre-installed. MVT is an open-source software tool designed for consensual mobile device forensics. It helps investigators and security researchers analyze Android and iOS devices to detect potential signs of compromise, particularly from sophisticated spyware like Pegasus. The tool utilizes indicators of compromise (IOCs) to scan device backups and identify traces of spyware infection or targeting. It also assists in extracting forensically sound data for further analysis. MVT is primarily intended for technical experts and is not designed for end-user self-assessment.</p><p>For more details about MVT, please check its official documentation: <a href=https://docs.mvt.re>https://docs.mvt.re</a></p><p><a href=/guides/g4>Have a look to the guide dedicated to device backup →</a></p><h2 id=mvt-and-colander>MVT and Colander <a href=#mvt-and-colander class=anchor aria-hidden=true>#</a></h2><p>By employing Colander within a digital investigation workflow, you have the capability to seamlessly integrate extracted Indicators of Compromise (IOCs) into MVT. This interoperability is achieved through the creation of a Structured Threat Information eXchange version 2 (STIX2) entity feed, a standardized format specifically designed for the communication of cyber threat intelligence. Essentially, Colander acts as a conduit, translating the findings of your investigation into a machine-readable format readily consumable by MVT.</p><p>The exported STIX2 feed serves as a repository of IOCs, encapsulating details such as file hashes, network indicators, and malicious domain names. This wealth of information empowers MVT to conduct in-depth examinations of mobile devices, potentially uncovering hidden threats or compromised data that may have eluded traditional detection methods. After creating your feed in Colander, execute the suggested commands on the computer running MVT.</p><figure class=text-center><img class="img-fluid lazyload blur-up d-block mx-auto shadow" data-sizes=auto src=/guides/g7/img/colander-feed_hu12883dbae8195cd4d8ffa444235f7e7e_98502_1800x0_resize_box_3.png data-srcset width=1397 height=523 alt="Example of entity feed in Colander"><noscript><img class="img-fluid d-block mx-auto shadow" sizes=100vw srcset src=/guides/g7/img/colander-feed.png width=1397 height=523 alt="Example of entity feed in Colander"></noscript><figcaption class=figure-caption><i>Example of entity feed in Colander</i></figcaption></figure><p>It&rsquo;s crucial to emphasize that the effectiveness of this integration hinges upon the accuracy and completeness of the initial investigation conducted in Colander. Meticulous data collection and analysis are paramount to ensure the generated STIX2 feed accurately reflects the true scope of the cyber threat you are investigating.</p><p>Furthermore, leveraging this combined approach requires a thorough understanding of both Colander&rsquo;s functionalities and MVT&rsquo;s capabilities. Familiarity with STIX2 data structures and the nuances of mobile device forensics is essential for interpreting the results and drawing meaningful conclusions from the extracted IOCs.</p><h2 id=overview-of-the-analysis-of-an-ios-device>Overview of the analysis of an iOS device <a href=#overview-of-the-analysis-of-an-ios-device class=anchor aria-hidden=true>#</a></h2><p>Follows a quick overview of the different steps required to analyze an iOS device using MVT:</p><ol><li><p>Connect the iOS device to the PiRogue. Use a USB cable to connect the iPhone or iPad to the PiRogue running MVT. Ensure the device is unlocked and trusted for data transfer.</p></li><li><p>Create an encrypted backup. Open a terminal window and navigate to your directory of choice. Use the command</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ mvt-ios backup --encrypted --password &lt;backup_password&gt; --output &lt;backup_path&gt;
</span></span></code></pre></div><p>to create an encrypted backup of the device. Replace <code>&lt;backup_password></code> with a strong password and <code>&lt;backup_path></code> with the desired location for the backup file.</p></li><li><p>Decrypt the backup. Once the backup is complete, use the command</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ mvt-ios decrypt-backup --password &lt;backup_password&gt; --input &lt;backup_path&gt; --output &lt;decrypted_path&gt;
</span></span></code></pre></div><p>to decrypt the backup file. Replace <code>&lt;backup_password></code> with the same password used for encryption and <code>&lt;decrypted_path></code> with the desired location for the decrypted files.</p></li><li><p>Analyze the decrypted backup. Use the command</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ mvt-ios check-backup --iocs &lt;ioc_path&gt; --output &lt;report_path&gt; &lt;decrypted_path&gt;
</span></span></code></pre></div><p>to analyze the decrypted backup for indicators of compromise (IOCs). Replace <code>&lt;ioc_path></code> with the path to the IOCs file, <code>&lt;report_path></code> with the desired location for the analysis report, and <code>&lt;decrypted_path></code> with the path to the decrypted backup folder.</p></li><li><p>Review the analysis report. The analysis report will contain details of any potential IOCs found during the scan. Review the report carefully to identify any suspicious findings and determine if further investigation is necessary.</p></li></ol><h2 id=overview-of-the-analysis-of-an-android-device>Overview of the analysis of an Android device <a href=#overview-of-the-analysis-of-an-android-device class=anchor aria-hidden=true>#</a></h2><p>Follows a quick overview of the different steps required to analyze an Android device using MVT:</p><ol><li><p>Enable USB debugging on the Android device. Go to <em>Settings > About Phone</em> and tap on the <em>Build Number</em> seven times to enable <em>Developer Options</em>. Then, go to <em>Settings > Developer Options</em> and enable <em>USB debugging</em>.</p></li><li><p>Connect the Android device to the PiRogue. Use a USB cable to connect the Android device to the PiRogue running MVT. Ensure the device is unlocked and authorized for USB debugging.</p></li><li><p>Analyze forensic data. Open a terminal and navigate to your directory of choice. Use the command</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ mvt-android check-adb -f --iocs &lt;ioc_path&gt; --output &lt;report_path&gt;
</span></span></code></pre></div><p>to analyze forensic data from the connected device. Replace <code>&lt;ioc_path></code> with the path to the IOCs file and <code>&lt;report_path></code> with the desired location for the analysis report.This will extract various information, including system logs, installed apps, and network connections.</p></li><li><p>Review the analysis report. The analysis report will contain details of any potential IOCs found during the scan. Review the report carefully to identify any suspicious findings and determine if further investigation is necessary.</p></li></ol><div class="page-footer-meta d-flex flex-column flex-md-row justify-content-between"></div></main></div></div></div><footer class="footer text-muted"><div class=container-xxl><div class=row><div class="col-lg-8 order-last order-lg-first"><ul class=list-inline><li class=list-inline-item></li></ul></div><div class="col-lg-8 order-first order-lg-last text-lg-end"><ul class=list-inline></ul></div></div></div></footer><script defer data-domain=pts-project.org src=https://plausible.io/js/script.js></script>
<script src=/js/bootstrap.min.8a4a3d8b214130d694b91942f330a0ec0c040217d0a2d422dd41c29176f49518f95cfb7846634f3b82e7fe358e0ba64b9b80263c759b07e85b7cc479c8875628.js integrity="sha512-iko9iyFBMNaUuRlC8zCg7AwEAhfQotQi3UHCkXb0lRj5XPt4RmNPO4Ln/jWOC6ZLm4AmPHWbB+hbfMR5yIdWKA==" crossorigin=anonymous defer></script>
<script src=/main.min.032f7f61db03165191ebf51143f7844840a639c8306d581472572d13d43b8a8d7bfa35f684782ab0505a3aa4bbf10089cc9501571550beea562134f6070752cb.js integrity="sha512-Ay9/YdsDFlGR6/URQ/eESECmOcgwbVgUclctE9Q7io17+jX2hHgqsFBaOqS78QCJzJUBVxVQvupWITT2BwdSyw==" crossorigin=anonymous defer></script></body></html>